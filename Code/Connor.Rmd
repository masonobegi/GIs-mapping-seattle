---
title: "Connor"
output: pdf_document
date: "2024-04-01"
---

```{r}
install.packages("tidyverse")
install.packages("dplyr")
library(tidyverse)
library(dplyr)
```


```{r}
#Loading in .csv files
Benchmarking2016 <- read.csv("../Data/2016_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2017 <- read.csv("../Data/2017_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2018 <- read.csv("../Data/2018_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2019 <- read.csv("../Data/2019_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2020 <- read.csv("../Data/2020_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2021 <- read.csv("../Data/2021_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2022 <- read.csv("../Data/2022_Building_Energy_Benchmarking.csv", header = TRUE)
```

```{r}
#Removing columns that are not available for year over year analysis
Bench2016 <- subset(Benchmarking2016, select = -c(Comments,Outlier,DefaultData) )
Bench2017 <- subset(Benchmarking2017, select = -c(Outlier,DefaultData) )
Bench2018 <- subset(Benchmarking2018, select = -c(Compliance.Issue, EPA.Building.Sub.Type.Name) )
Bench2019 <- subset(Benchmarking2019, select = -c(ComplianceIssue) )
Bench2020 <- subset(Benchmarking2020, select = -c(ComplianceIssue) )
Bench2021 <- subset(Benchmarking2021, select = -c(ComplianceIssue) )
Bench2022 <- subset(Benchmarking2022, select = -c(ComplianceIssue) )
```


```{r}
#find stores
stores2016 = Bench2016 %>% filter(PrimaryPropertyType == "Supermarket / Grocery Store")
#necessary cols
stores2016 = stores2016 %>% select(OSEBuildingID,PropertyName,Address,YearBuilt,NumberofBuildings,NumberofFloors,PropertyGFATotal,PropertyGFAParking,PropertyGFABuilding.s.,ENERGYSTARScore,SiteEUIWN.kBtu.sf.,SiteEnergyUseWN.kBtu.,SourceEUIWN.kBtu.sf.,Electricity.kWh.,Electricity.kBtu.,NaturalGas.therms.,NaturalGas.kBtu.,ComplianceStatus,TotalGHGEmissions,GHGEmissionsIntensity)
```

```{r}
#same for 2022
stores2022 = Bench2022 %>% filter(EPAPropertyType == "Supermarket/Grocery Store")
# 5 less stores in 2022 than 2016
stores2022 = stores2022 %>% select(OSEBuildingID,BuildingName,Address,YearBuilt,NumberofBuildings,NumberofFloors,PropertyGFATotal,PropertyGFAParking,PropertyGFABuilding.s.,ENERGYSTARScore,SiteEUIWN.kBtu.sf.,SiteEnergyUseWN.kBtu.,SourceEUIWN.kBtu.sf.,Electricity.kWh.,Electricity.kBtu.,NaturalGas.therms.,NaturalGas.kBtu.,ComplianceStatus,TotalGHGEmissions,GHGEmissionsIntensity)
```

```{r}
s2016 = stores2016 %>% select(OSEBuildingID,PropertyName,PropertyGFATotal,ENERGYSTARScore,SourceEUIWN.kBtu.sf., )
s2022 = stores2022 %>% select(OSEBuildingID,BuildingName,PropertyGFATotal,ENERGYSTARScore,SourceEUIWN.kBtu.sf.)
```

```{r}
s2022 = s2022 %>% filter(!is.na(SourceEUIWN.kBtu.sf.))

target_stores = s2022 %>% filter(ENERGYSTARScore < 80)
```






