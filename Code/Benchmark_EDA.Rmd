```{r}
#Loading in .csv files
Benchmarking2016 = read.csv("../Data/2016_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2017 = read.csv("../Data/2017_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2018 = read.csv("../Data/2018_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2019 = read.csv("../Data/2019_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2020 = read.csv("../Data/2020_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2021 = read.csv("../Data/2021_Building_Energy_Benchmarking.csv", header = TRUE)
Benchmarking2022 = read.csv("../Data/2022_Building_Energy_Benchmarking.csv", header = TRUE)

```

```{r}
#Removing columns not present in all years
Bench2016 = subset(Benchmarking2016, select = -c(Comments,Outlier,DefaultData) )
Bench2017 = subset(Benchmarking2017, select = -c(Outlier,DefaultData) )
Bench2018 = subset(Benchmarking2018, select = -c(Compliance.Issue, EPA.Building.Sub.Type.Name) )
Bench2019 = subset(Benchmarking2019, select = -c(ComplianceIssue) )
Bench2020 = subset(Benchmarking2020, select = -c(ComplianceIssue) )
Bench2021 = subset(Benchmarking2021, select = -c(ComplianceIssue) )
Bench2022 = subset(Benchmarking2022, select = -c(ComplianceIssue) )
```

```{r}
#Adding columns of NULL values
Bench2018['TaxParcelIdentificationNumber'] <- NA
Bench2018['NumberofBuildings'] <- NA
Bench2018['YearsENERGYSTARCertified'] <- NA
Bench2018['ListOfAllPropertyUseTypes'] <- NA
Bench2019['YearsENERGYSTARCertified'] <- NA
Bench2019['NumberofBuildings'] <- NA
Bench2019['ListOfAllPropertyUseTypes'] <- NA
Bench2020['YearsENERGYSTARCertified'] <- NA
Bench2020['ListOfAllPropertyUseTypes'] <- NA
Bench2021['YearsENERGYSTARCertified'] <- NA
Bench2021['ListOfAllPropertyUseTypes'] <- NA
Bench2022['YearsENERGYSTARCertified'] <- NA
Bench2022['ListOfAllPropertyUseTypes'] <- NA

```

```{r}
#Renaming columns in 2018 so that naming conventions match other years
names(Bench2018)[1] <- "OSEBuildingID"
names(Bench2018)[2] <- "DataYear"
names(Bench2018)[3] <- "PropertyName"
names(Bench2018)[4] <- "BuildingType"
names(Bench2018)[8] <- "ZipCode"
names(Bench2018)[12] <- "CouncilDistrictCode"
names(Bench2018)[13] <- "YearBuilt"
names(Bench2018)[14] <- "NumberofFloors"
names(Bench2018)[15] <- "PropertyGFATotal"
names(Bench2018)[17] <- "PropertyGFAParking"
names(Bench2018)[18] <- "PrimaryPropertyType"
names(Bench2018)[19] <- "ENERGYSTARScore"
names(Bench2018)[26] <- "LargestPropertyUseType"
names(Bench2018)[27] <- "LargestPropertyUseTypeGFA"
names(Bench2018)[28] <- "SecondLargestPropertyUseType"
names(Bench2018)[29] <- "SecondLargestPropertyUseTypeGFA"
names(Bench2018)[30] <- "ThirdLargestPropertyUseType"
names(Bench2018)[31] <- "ThirdLargestPropertyUseTypeGFA"
names(Bench2018)[35] <- "ComplianceStatus"
names(Bench2018)[38] <- "GHGEmissionsIntensity"
names(Bench2018)[39] <- "TotalGHGEmissions"

```

```{r}
#Renaming columns between the years of data with conventions that do not match
names(Bench2019)[3] <- "PropertyName"
names(Bench2020)[3] <- "PropertyName"
names(Bench2020)[27] <- "PrimaryPropertyType"
names(Bench2021)[3] <- "PropertyName"
names(Bench2021)[27] <- "PrimaryPropertyType"
names(Bench2022)[3] <- "PropertyName"
names(Bench2022)[27] <- "PrimaryPropertyType"
```

```{r}
#Specifying the order of the columns
col_order <- c("OSEBuildingID", "DataYear", "BuildingType", "PrimaryPropertyType",
               "PropertyName", "Address", "City", "State",
               "ZipCode", "TaxParcelIdentificationNumber", "CouncilDistrictCode", "Neighborhood",
               "Latitude", "Longitude", "YearBuilt", "NumberofBuildings",
               "NumberofFloors", "PropertyGFATotal", "PropertyGFAParking", "PropertyGFABuilding.s.",
               "ListOfAllPropertyUseTypes", "LargestPropertyUseType", "LargestPropertyUseTypeGFA", "SecondLargestPropertyUseType",
               "SecondLargestPropertyUseTypeGFA", "ThirdLargestPropertyUseType", "ThirdLargestPropertyUseTypeGFA", "YearsENERGYSTARCertified",
               "ENERGYSTARScore", "SiteEUI.kBtu.sf.", "SiteEUIWN.kBtu.sf.", "SourceEUI.kBtu.sf.",
               "SourceEUIWN.kBtu.sf.", "SiteEnergyUse.kBtu.", "SiteEnergyUseWN.kBtu.", "SteamUse.kBtu.",
               "Electricity.kWh.", "Electricity.kBtu.", "NaturalGas.therms.", "NaturalGas.kBtu.",
               "ComplianceStatus", "TotalGHGEmissions", "GHGEmissionsIntensity")
```

```{r}
#Changing the order of the columns so that they are consistent
Bench2016 <- Bench2016[,col_order]
Bench2017 <- Bench2017[,col_order]
Bench2018 <- Bench2018[,col_order]
Bench2019 <- Bench2019[,col_order]
Bench2020 <- Bench2020[,col_order]
Bench2021 <- Bench2021[,col_order]
Bench2022 <- Bench2022[,col_order]
```


```{r}
#Binding data years together
Bound2016_17 = rbind(Bench2016, Bench2017)
Bound2016_18 = rbind(Bench2016, Bench2018)
Bound2016_19 = rbind(Bench2016, Bench2019)
Bound2016_20 = rbind(Bench2016, Bench2020)
Bound2016_21 = rbind(Bench2016, Bench2021)
Bench2016_22 = rbind(Bench2016, Bench2022)
```

```{r}
#Creating .csv file with all variables consistent between the dataset years.
write.csv(Bench2016_22, "Bench2016_22.csv", row.names = FALSE)
```

```{r}
#Checking for NULL values.
null_counts <- colSums(is.na(Bench2016_22))

print(null_counts)
```
```{r}
#Taking out columns with too many NULL values to be useful.
Bench_cleaned = subset(Bench2016_22, select = -c(ListOfAllPropertyUseTypes, SecondLargestPropertyUseType, SecondLargestPropertyUseTypeGFA, ThirdLargestPropertyUseType, ThirdLargestPropertyUseTypeGFA, YearsENERGYSTARCertified, ENERGYSTARScore, SteamUse.kBtu., NaturalGas.therms., NaturalGas.kBtu.) )
```

```{r}
ncol(Bench_cleaned)
colnames(Bench_cleaned)
summary(Bench_cleaned)
```
```{r}
#Creating new .csv file with remaining useful columns of data.
write.csv(Bench_cleaned, "Bench_cleaned.csv", row.names = FALSE)
```




